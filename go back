<?php 
    include('components/connection.php');

        function fixedDecimal($value, $number){
        return number_format((float)$value, 2, '.', ''); 
    }
?>

<?php include("components/header.php"); ?>
<title>PricePalace Discount Wholesale Data Warehouse</title>
</head>

<body>
    <?php include("components/menu.php"); ?>
     
    <div class="container-fluid">
        <div class="row">
            <?php include("components/sidebar.php"); ?>

            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Report 6: State with Highest Volume for Each Category</h1>
            
                </div>

                <h4>Please Select Year and Month you would like to look at </h4>
                <div class="table-responsive">
                    <table class="table table-striped table-sm">
            
                    <form method="get" action="report_6_2_state_with_highest_volume_by_category.php" >
                    <div class="form-row">
                        <div class="col">
                           
                            <select class="form-control" name="selectedYear">
                        
                            <?php                               
                                        $query = "
                                                SELECT DISTINCT t.YEAR
                                                FROM
                                                (SELECT YEAR(fk_SaleRecord_date_time_Date_date_time) AS YEAR, MONTH(fk_SaleRecord_date_time_Date_date_time) AS MONTH
                                                FROM cs6400_fa20_team002.salerecord) AS t;
                                                ";
                                                
                                        $result = mysqli_query($db, $query);
                                        if (!empty($result) && (mysqli_num_rows($result) == 0) ) {
                                            array_push($error_msg,  "SELECT ERROR: find Friendship <br>" . __FILE__ ." line:". __LINE__ );
                                        }
                                        
                                        while ($row = mysqli_fetch_array($result, MYSQLI_ASSOC)){
                                                    print "<option value='{$row['YEAR']}'>{$row['YEAR']}</option>";           
                                        }                                   
                                    ?>
                            </select>
                            </div>

                            <div class="col">
                          
                            <select class="form-control" name="selectedMonth">

                                         <?php                               
                                            $query = "
                                                    SELECT DISTINCT t.MONTH
                                                    FROM
                                                    (SELECT MONTH(fk_SaleRecord_date_time_Date_date_time) AS MONTH
                                                    FROM cs6400_fa20_team002.salerecord) AS t;
                                                    ";
                                                    
                                            $result = mysqli_query($db, $query);
                                            if (!empty($result) && (mysqli_num_rows($result) == 0) ) {
                                                array_push($error_msg,  "SELECT ERROR: find Friendship <br>" . __FILE__ ." line:". __LINE__ );
                                            }
                                            
                                            while ($row = mysqli_fetch_array($result, MYSQLI_ASSOC)){
                                                        print "<option value='{$row['MONTH']}'>{$row['MONTH']}</option>";           
                                            }                                   
                                        ?>
                            </select>

                            </div>

                            <div class="col">
                                <input type="submit" type="button" class="btn btn-primary" value="Submit"/>
                            </div>
                            
                    </form>
                </div>
                 
                <?php include("components/error.php"); ?>
                
                <div class="clear"></div>       
                </div>    
        
                <?php include("components/footer.php"); ?>
            
            </main>
        </div>
    </div>

   
</body>
</html>